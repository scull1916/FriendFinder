<!DOCTYPE html>

<html lang="en-us">

	<head>
		<title>Friend Finder</title>

		<meta charset="utf-8">

		<!--Bootstrap CDN -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

		<!-- jQuery CDN -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

		<!-- Font Awesome -->
		<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>


	</head>

	<body>
		<form>

		    <h2>Survey Questions</h2>
		    <hr>

			
			<div class="form-group">
			    <h3><strong>About You</strong></h3>
			    <h4>Name (Required)</h4>
			    <input type="text" id="name" class="form-control col-md-4" required="">

			    <h4>Link to Photo Image (Required)</h4>
			    <input type="text" id="photo" class="form-control col-md-4" required="">
			</div>

			    <hr>
				  <div class="form-group">
				  	<h3><strong>Question 1</strong></h3>
				  	<h5>A week in Las Vegas is my idea of a great vacation.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q1">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 2</strong></h3>
				  	<h5>A fried egg on top of a hamburger is a brilliant idea.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q2">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 3</strong></h3>
				  	<h5>There are few better ways to spend a day than a hike in the woods.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q3">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 4</strong></h3>
				  	<h5>I like loud, raucous parties.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q4">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

			      <div class="form-group">
				  	<h3><strong>Question 5</strong></h3>
				  	<h5>I'm always looking for something new to learn.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q5">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 6</strong></h3>
				  	<h5>I prefer to hit the mountains to ski.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q6">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 7</strong></h3>
				  	<h5>Sun, sand, waves - ah, the beach life!</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q7">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 8</strong></h3>
				  	<h5>I believe firmly in keeping up on the news.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q8">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 9</strong></h3>
				  	<h5>All you really need to know is the location of the library.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q9">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>

				  <div class="form-group">
				  	<h3><strong>Question 10</strong></h3>
				  	<h5>Chocolate dark, coffee black, and beer hoppy.</h5>
				    <label for="exampleFormControlSelect2">Select an option</label>
				    <select class="form-control col-sm-2" id="q10">
				      <option value="1">1 (Strongly Disagree)</option>
				      <option value="2">2</option>
				      <option value="3">3</option>
				      <option value="4">4</option>
				      <option value="5">5 (Strongly Agree)</option>
				    </select>
				  </div>			    
			    <br>
			    <br>

			    <!-- Submit Button -->
			    <button type="submit" class="btn btn-primary btn-lg" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
			     Submit</button>

			    <hr>


		  </div>
		</form>
			<footer class="footer">
				<p>
					<a href="/api/friends">API Friends List</a>
					  |  
					<a href="https://github.com/scull1916/FriendFinder">Github Repo<a>
				</p>
			</footer>
		</div>
		


	</body>

	<script type="text/javascript">

		//on the button click, capture user's survey answers
		$("#submit").on("click", function(event)
			{
				event.preventDefault();

				//assign form input to a variable
				var newFriend = 
				{
					name: $("#name").val().trim(),
					photo: $("#photo").val().trim(),
					scores: [
								$("#q1").val().trim(),
								$("#q2").val().trim(),
								$("#q3").val().trim(),
								$("#q4").val().trim(),
								$("#q5").val().trim(),
								$("#q6").val().trim(),
								$("#q7").val().trim(),
								$("#q8").val().trim(),
								$("#q9").val().trim(),
								$("#q10").val().trim()
							]
							
				};

				//post the new data so that it will present with the other objects in the friends.js file
				$.post("/api/friends", newFriend);


				
				//call the function which will compare the new object to the other objects in friends.js
				friendComp();

			});
		//assign global variables which can be easily accessed to aid in the friend comp process
		
		// tempArray will hold the friends.js object for iteration & comparison with new friend object
		var tempArray = [];

		var comp = 0;

		var count = 0;

		function friendComp()
		{
			var currentURL = window.location.origin;

			$.ajax({url: currentURL + "/api/friends", method: "GET"})
			.then(function(friends)
				{
					//initialize the variable which will hold the closest friend based on comp
					var closestFriend = "";
					
					//initialize a variable to hold the calculate difference between the new friend and current friends objects
					var arrayDiff = 0;

					//initialize a variable which will hold the lowest scored difference between the new friend and the current friend; will help determine the closest friend.
					var scoreDiff = 100;

					//set a variable to hold the most recent friend addition to the array
					var lastIn = friends.length-1;


					function holdScores()
					{
						//assign the current friends scores to a temp array for comparison
						tempArray = friends[count].scores;
						console.log("holdScores-tempArray: " + tempArray);


						//compare the scores of the current friend to the scores of the new friend
						for (i=0; i<friends.length; i++)
						{
							
							comp = Math.abs(tempArray.scores[i] - friends[lastIn].scores[i]);
							console.log("comp: " + comp);
							
							//calculate and save the total array difference at each iteration through the scores arrays
							arrayDiff = arrayDiff+comp;
							console.log("arrayDiff: " + arrayDiff);
							
							//compare arrayDiff with scoreDiff, the lower score is assigned to scoreDiff
							if (arrayDiff<scoreDiff)
							{
								scoreDiff = arrayDiff;

								//assign closestFriend based on the scoreDiff between current and new friend
								closestFriend = friends[count].name;
								
							}

							
						}

						//call the compScores function to iterate to the next friend for comparison to the new friend
						compScores();
					}

					//this function will determine if more friends need to be compared to the new friend and when to know there are no more friends to compare with
					function compScores()
					{
						
						if(count<friends.length)
							{
								count++;
								holdScores();
							}

					}
	
					//once the comparison is complete, post the message announcing the closest friend
					alert("Your closest match is: " + closestFriend);


				});
			
		}

		

	</script>



</html>